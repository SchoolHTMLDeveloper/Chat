<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Admin Panel</title>
  <style>
    body { background: #0d0d0d; color: white; font-family: Arial; padding: 20px; }
    input, button { padding: 8px; margin: 5px; border-radius: 5px; border: none; }
    button { background: purple; color: white; cursor: pointer; }
    table { border-collapse: collapse; width: 100%; margin-top: 10px; }
    th, td { border: 1px solid #555; padding: 8px; }
  </style>
</head>
<body>
  <h1>Admin Panel</h1>

  <h2>Manually Ban User</h2>
  <input id="banUsername" placeholder="Username (optional)" />
  <input id="banId" placeholder="User ID / Cookie" />
  <input id="banReason" placeholder="Reason" />
  <button id="banBtn">Ban</button>

  <h2>Currently Banned Users</h2>
  <table id="bans">
    <tr><th>Username</th><th>Cookie/UserID</th><th>Reason</th><th>Unban</th></tr>
  </table>

  <script>
    // Load bans from server
    async function loadBans() {
      const res = await fetch("/api/bans");
      const data = await res.json();
      const table = document.getElementById("bans");

      table.innerHTML = "<tr><th>Username</th><th>Cookie/UserID</th><th>Reason</th><th>Unban</th></tr>";

      data.forEach(b => {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${b.username || "Unknown"}</td>
          <td>${b.cookie}</td>
          <td>${b.reason}</td>
          <td><button onclick="unban('${b.cookie}')">Unban</button></td>
        `;
        table.appendChild(row);
      });
    }

    // Ban button
    document.getElementById("banBtn").onclick = async () => {
      const username = document.getElementById("banUsername").value || "Unknown";
      const id = document.getElementById("banId").value.trim();
      const reason = document.getElementById("banReason").value.trim();
      const password = prompt("Admin password:");

      if (!id || !reason || !password) return alert("All fields required.");

      const res = await fetch("/admin/ban", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ id, username, reason, password })
      });

      alert(await res.text());
      loadBans();
    };

    // Unban function
    async function unban(id) {
      const password = prompt("Admin password:");
      if (!password) return;

      const res = await fetch("/admin/unban", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ id, password })
      });

      alert(await res.text());
      loadBans();
    }

    // Initial load
    loadBans();
  </script>
</body>
</html>
